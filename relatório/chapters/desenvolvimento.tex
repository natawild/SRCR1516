\chapter{Introdução}
\label{cap:p1}
Este primeiro capítulo tem como objetivo apresentar uma breve introdução ao exercício a realizar. Sendo assim, é necessário perceber os motivos que levaram à resolução do exercício assim como os objetivos pretendidos.
A Programação em Lógica é um tipo específico de programação cujo objetivo é a implementação de um programa cujo conteúdo se prende em factos (registos que se sabem verdadeiros), predicados (associados aos factos) e regras. A este programa podem ser estruturadas questões sobre o seu conteúdo e obter-se-ão respostas válidas e corroboradas pela lógica em si.
A programação em lógica baseia-se em dois princípios básicos para a “descoberta” das respostas (soluções) a essas questões: lógica, usada para representar os conhecimentos e informação, e Inferência, regras aplicadas à Lógica para manipular o conhecimento.




\section{Motivação e Objetivos}
\label{p1:MotivObj}
O PROLOG é uma linguagem declarativa, pois fornece uma descrição do problema que se pretende computar utilizando uma coleção de factos e regras lógicas que indicam como deve ser resolvido o problema proposto. Sendo também uma linguagem que é especialmente associada com a inteligência artificial e linguística computacional este é um dos grandes motivos que nos levou a querer aprender este tipo de linguagem, esta mais direcionada ao conhecimento do que aos algoritmos. 


Após os conhecimentos adquiridos na linguagem de programação lógica PROLOG, este exercício surge com o objetivo de consolidar conhecimentos e obter experiência e prática face a problemas de programação em lógica. O objetivo final será a construção de um programa capaz de armazenar conhecimento sobre registo de eventos numa instituição de saúde e através deste solucionar questões deste tema.



\section{Estrutura do documento}
\label{p1:Estrutura}
O presente relatório encontra-se organizado em seis capítulos. Sendo que neste primeiro introduzimos a linguagem e o tema a tratar menciona-se também a motivação e os objetivos que nos levaram à realização deste exercício. 
No segundo capítulo será feito um estudo prévio da linguagem de modo a que o leitor possa entender o exercício. No terceiro capítulo explicaremos o que foi desenvolvido para a implementação do exercício. No quarto capítulo apresentaremos as conclusões e interpretação dos resultados obtidos. Por fim nos últimos dois capítulos será apresentada a bibliografia consultada, no quinto capítulo e os anexos no sexto. 




\chapter{Preliminares}
\label{cap:p2}
Neste capítulo vao ser apresentados alguns conceitos fundamentais para a elaboraçãoo deste
exercício e algumas das ferramentas fundamentais para a elaboração do mesmo.


\section{Estudos anteriores}
\label{p2:estudp}

Para a realização deste trabalho foram necessários alguns conhecimentos anteriores sobre programação em lógica e, posteriormente, o uso da linguagem de programação PROLOG.
Este conhecimento foi adquirido ao longo das aulas teóricas ( programação em lógica) e aulas
teórico-práticas (PROLOG) de Sistemas de Representação de Conhecimento e Raciocínio.
Sobre estes conhecimentos, devemos destacar todos os conceitos que foram aprendidos tais
como o que são predicados, o que são cláusulas, o que é a base de conhecimento, entre outros
conceitos de programação em lógica que serão explicados ao longo deste documento.
Após termos alguns conhecimentos de programação em lógica falta colocá-los em prática,
e, é aqui, que entram os conhecimentos de PROLOG e da ferramenta \textit{SICSTus} usada para
compilar e interpretar o código desenvolvido nesta linguagem.
\\


Para o desenvolvimento desses predicados foi necessário fazer uma análise de conhecimentos de cada um dos membros sobre o tema e acompanhado de uma pequena pesquisa sobre as características destes.

O estudo inicial passou por caracterizar um utente, este que é definido pelo nome, serviço em que está inscrito ou consultado, profissional atribuído e a instituição onde o profissional exerce e onde o utente é atendido, que devem coincidir. Na realidade, o utente é composto por muitos outros factores, tal como, número de utente, número de contribuinte, número de cartão de cidadão entre muitos outros mas para a resolução dos critérios mínimos apenas são requeridos os mencionados anteriormente, pois as questões não pretendem incidir nesses campos.
\\

Um serviço é caracterizado pelo nome, isto é o nome do serviço terá de ser elucidativo, por exemplo, “pediatria” e pela instituição a que corresponde ao nome do local onde se presta esse serviço aos utentes, e como tal será algo como “hospital....” ou “centro de saúde...” ou algo semelhante que reflita que esse local é um local em que se prestam determinados serviços na área da saúde.
\\

Um profissional é caracterizado pelo seu nome, serviço em que está inserido, sendo que pode estar em mais que um serviço e a instituição onde labora. E estes são apenas os requisitos mínimos que permitem ao sistema determinar as respostas a todas as questões, mas um profissional é algo mais que isto. 
\\

Uma instituição é caracterizada apenas pelo seu nome por forma a simplificar este sistema visto que os requisitos mínimos não pretendem questionar nada de especial que implique que a instituição tenha de ter algo mais no seu predicado além do seu nome.


\section{Programação em Lógica e PROLOG}
\label{p2:proglogprolog}
De modo a que a leitura deste documento seja perceptível em termos de conceitos e símbolos é necessário fazer referências breves a noções básicas de PROLOG, a linguagem em que é desenvolvido este trabalho.
Tal como foi mencionado anteriormente uma linguagem de programação lógica utiliza a lógica para representar conhecimento e inferências para manipular informação. Um programa neste tipo de programação possui então os seguintes parâmetros:

\begin{itemize}
	\item Factos - constatações sobre algo que se conhece e se sabe verdadeiro, por exemplo cor( azul )
	\item Predicados – implementam relações, por exemplo o predicado filho( filho, pai ) implementa a relação de descendência direta (ser filho de)
	\item Regras – utilizadas para definir novos predicados. 
\end{itemize}

Estes são alguns exemplos dos conhecimentos base para perceber a programação em lógica.
Após se ter estes conhecimentos, é necessário traduzir estes e aplicá-los na linguagem PROLOG.
Deixamos, então, alguns exemplos importantes para a usar:

\begin{itemize}
	\item .  utilizado para terminar uma declaração;
	\item :-  significa “se”;
	\item ,  possui o significado “e”;
	\item ;  significa “ou”;
	\item //  representa a unificação;
\end{itemize}

É ainda necessário referir que as variáveis representam-se por maiúsculas e constantes, predicados e factos com minúsculas.
Com estas noções como base passa-se agora ao desenvolvimento das tarefas do exercício.



\chapter{Descrição do Trabalho e Análise de Resultados}
\label{cap:p3}

Nesta parte do documento serão explicitadas todas as etapas de resolução dos desafios fornecidos bem como todas as decisões efetuadas no processo.


\section{Base de Conhecimento}
\label{p3:baseConhe}

A base de Conhecimento define bases de dados ou conhecimento acumulados sobre determinado assunto.
Para a elaboração deste exercício tornou-se importante definir uma base de conhecimento
que possa responder aos pedidos do enunciado.

\subsection{Instituições}

De acordo com o enunciado existem as instituições de saúde estas que têm a elas associados serviços e estes têm profissionais e respetivos utentes. 

Para a implementação do exercício foi necessário criar uma base de conhecimento das instituições existentes 
Como tal usamos o predicado instituição para descrever esta relação: \textbf{instituição(nome).}, como no exemplo: 

\begin{verbatim}
instituicao( hospital_guimaraes ). 
instituicao( hospital_braga ).
instituicao( hospital_barcelos ).
\end{verbatim}

Como uma instituição tem a si associado respetivo serviço usámos o predicado \textbf{instserv} com a  assinatura \textbf{instserv (intituicao,servico).}, para relacionar a intituição com o respetivo serviço, como se pode verificar no exemplo abaixo: 

\begin{verbatim}
instserv( hospital_braga, cardiologia ).
instserv( hospital_beatriz_angelo, endocrinologia ).
\end{verbatim}

\subsection{Serviços}
Um requisito a incluir na base de conhecimento é a existencia de serviços, para representar esta situação temos o predicado servico com a assinatura \textbf{servico(nome).}


\begin{Verbatim}
servico( cardiologia ). 
servico( cirugiageral ).
servico(  neurologia ).
\end{Verbatim}

\subsection{Profissionais}
Mais um requisito do sistema a incluir na base de conhecimento é a existencia de profissionais com a seguinte assinatura \textbf{profissional(codigo, nome).}


\begin{Verbatim}
profissional(1,marcus).
profissional(2,maria).
profissional(3,jorge).
\end{Verbatim}

\subsection{Utentes }
Por fim, incluimos os utentes na base de conhecimento estes com a assinatura \textbf{utente(codigo,nome).}

\begin{Verbatim}
utente(1,jose).  
utente(2,carlos). 
utente(3,maria). 
\end{Verbatim}

Como os utentes pertencem a uma certa instituição de saúde foi necessário introduzir esse conhecimento na base sendo a sua assinatura \textbf{utentinst(utente,instituicao).}

\begin{verbatim}
utentinst(1, hospital_barcelos ). 
utentinst(3, hospital_porto ).
utentinst(2, hospital_trofa ). 
\end{verbatim}

\subsection{Relacionamento entre Entidades}
Relacionamos instituição de saúde com os seviços prestados pelo profissional com o utente. Introduzimos na base de conhecimento o predicado \textbf{ins\_serv\_uten\_profi( intituicao, servico,Codigo utente, Codigo profissional ).} 

\begin{verbatim}
ins_serv_uten_profi( hospital_braga, cardiologia,1,1 ).
ins_serv_uten_pofi( hospital_trofa, cardiologia,1,1 ).
\end{verbatim}

\section{Funcionalidades Básicas}
Após a apresentação da base de conhecimento do exercício torna-se possivel desenvolver alhuns teoremas e axiomas que consigam responder aos desafios apresentados. Desta forma, apresentaremos e explicaremos a forma como resolvemos cada um dos desafios e quais os resultados obtidos pelas soluções por nós apresentadas. 
\subsection{Identificar os serviços existentes numa instituição}
Pretende-se que seja possivel apresentar todos os serviços existentes numa determinada instituição de saúde. Para tal basta procurar todos os serviços que estejam ligados à instituição pretendida através do axioma \textit{servicoInst(Inst,Serv)}, este que nos devolve uma lista de todos os serviços.  
Segue de seguida o axioma implementado: 
\begin{verbatim}
servicoInst(Inst,Serv):-
findall(K,ins_serv_uten_profi(Inst,K,_,_),Serv).      

servicoInst(Inst,[Serv|K]):- 
ins_serv_uten_profi(Inst,Serv,_,_),
servicoInst(Inst,K).

servicoInst(Inst,[Serv]):- 
ins_serv_uten_profi(Inst,Serv,_,_).
\end{verbatim}

Mostramos de seguida o output do programa para este axioma. 

\begin{figure}[<+htpb+>]
	\centering
	\includegraphics[scale=0.9]{answer1.png}
	\caption{Exemplo de output do programa}
	\label{p3:fig:output1}
\end{figure}

\subsection{Identificar os utentes de uma instituição}
Para identificar todos os utentes de uma instituição, o método será semelhante ao anterior, pois é necessário selecionar os utentes que pertencem a determinada instituição. Usamos assim o axioma \textit{utentesInst(Inst,Uten)}, que permite encontrar todos os utentes de uma dada instituição, mostramos de seguida o axioma implementado para este desafio: 

\begin{verbatim}
utentesInst(Inst,Uten):-
findall((K,J),(ins_serv_uten_profi(Inst,_,K,_),utente(K,J)),Uten).      

utentesInst(Inst,[(Cod,Uten)|K]):- 
ins_serv_uten_profi(Inst,_,Cod,_),
utente(Cod,Uten),
utentesInst(Inst,K).

utentesInst(Inst,[(Cod,Uten)]):-
ins_serv_uten_profi(Inst,_,Cod,_),
utente(Cod,Uten).
\end{verbatim}

O output produzido pela execução do axioma :
\begin{figure}[<+htpb+>]
	\centering
	\includegraphics[scale=0.9]{answer2.png}
	\caption{Exemplo da execução do axioma utentesInst}
	\label{p3:fig:output2}
\end{figure}


\subsection{Identificar os utentes de um determinado serviço}
Mais uma vez a forma de identificar os utentes de determinado serviço é semelhante às anteriores em que usámos a funcionalidade \textit{findall} que nos devolve uma lista com os utentes, neste caso o código de utente e o respetivo nome. 

\begin{verbatim}
servUtente(Serv,Ute):-
	findall((K,J),(ins_serv_uten_profi(_,Serv,K,_),utente(K,J)),Ute).

servUtente(Serv,[(Cod,Uten)|K]):- ins_serv_uten_profi(_,Serv,Cod,_),
utente(Cod,Uten), 
servUtente(Serv,K).

servUtente(Serv,[(Cod,Uten)]):- ins_serv_uten_profi(_,Serv,Cod,_),
utente(Cod,Uten).
\end{verbatim}

Mostrámos de seguida o output da execução do axioma: 

\begin{figure}[<+htpb+>]
	\centering
	\includegraphics[scale=0.9]{answer3.png}
	\caption{Exemplo da execução do axioma servUtente}
	\label{p3:fig:output3}
\end{figure}

\subsection{Identificar os utentes de um determinados serviço numa instituição}
Para a identificação dos utentes que estão num determinado serviço numa certa instituição de saúde, implementamos o axioma \textit{utenServInst(Serv,Inst,Uten)}, este que procura o serviço, a intituição e os utentes. 
\begin{verbatim}
utenServInst(Serv,Inst,Uten):- 
findall((K,J),(ins_serv_uten_profi(Inst,Serv,K,_),utente(K,J)),Uten). 

utenServInst(Serv,Inst,[(Cod,Uten)|K]):- utente(Cod,Uten),
ins_serv_uten_profi(Inst,Serv,Cod,_),
utenServInst(Serv,Inst,K).

utenServInst(Serv,Inst,[(Cod,Uten)]):- ins_serv_uten_profi(Inst,Serv,Cod,_),
utente(Cod,Uten).
\end{verbatim}

\begin{figure}[<+htpb+>]
	\centering
	\includegraphics[scale=0.9]{answer4.png}
	\caption{Exemplo da execução do axioma utenServInst}
	\label{p3:fig:output4}
\end{figure}


\subsection{Identificar as instituições onde seja prestado um dado serviço ou conjunto de serviços}



\begin{verbatim}
 instServicos([Serv|K],I):-    
 findall(H,servicoInst(H,[Serv|K]),L),
 eliminarRepetidos(L,I).
 
 inst_Servico(S,[I|K]):- servicoInst(I,[S]),
 inst_Servico(S,K).  
 
 inst_Servico(S,[I]):- servicoInst(I,[S]).
 
 instServicos([S|T],[I|K]):-inst_Servico(S,[I|K]),instServicos(T,[I|K]).
 instServicos([S],[I|K]):-inst_Servico(S,[I|K]).
 instServicos([S],[I]):-inst_Servico(S,[I]).
\end{verbatim}


\begin{figure}[<+htpb+>]
	\centering
	\includegraphics[scale=0.9]{answer5.png}
	\caption{Exemplo da execução do axioma instServicos}
	\label{p3:fig:output5}
\end{figure}

\subsection{Identificar os serviços que não se podem encontrar numa instituição}

\begin{verbatim}
todosServicos(L):-
findall(S,servico(S),L).

servicosForaInst(Ins,Serv,todos):-todosServicos(P), 
servicoInst(Ins,K),
difList(P,K,Serv).

servicosForaInst(Ins,[Serv|K]):-nao(servicoInst(Ins,[Serv|K])).
\end{verbatim}


\begin{figure}[<+htpb+>]
	\centering
	\includegraphics[scale=0.6]{answer6.png}
	\caption{Exemplo da execução do axioma servicosForaInst}
	\label{p3:fig:output6}
\end{figure}

\subsection{Determinar as instituições onde um profissional presta serviço }
\begin{verbatim}
profiServico((Cod,Prof),Inst):- 
findall(K,(ins_serv_uten_profi(K,_,_,Cod),profissional(Cod,Prof)),Inst).

profiServico((Cod,Prof),[Inst|K]):-ins_serv_uten_profi(Inst,_,_,Cod),
profissional(Cod,Prof),
profiServico((Cod,Prof),K).

profiServico((Cod,Prof),[Inst]):-ins_serv_uten_profi(Inst,_,_,Cod),
profissional(Cod,Prof).
\end{verbatim}

\begin{figure}[<+htpb+>]
	\centering
	\includegraphics[scale=0.9]{answer7.png}
	\caption{Exemplo da execução do axioma profiServico}
	\label{p3:fig:output7}
\end{figure}

\subsection{Determinar todas as instituições(ou serviços ou profissionais) a quem o utente já recorreu}

\begin{verbatim}
instSerProf((Cod,Uten),Inst,ints):-
 findall(K,(ins_serv_uten_profi(K,_,Cod,_),utente(Cod,Uten)),L),
eliminarRepetidos(L,Inst).

instSerProf((CodU,Uten),Serv,serv):-
findall(K,(ins_serv_uten_profi(_,K,CodU,_),utente(CodU,Uten)),L),
eliminarRepetidos(L,Serv).

instSerProf((CodU,Uten),Prof,prof):-
findall((K,Nome),(ins_serv_uten_profi(_,_,CodU,K),utente(CodU,Uten),
profissional(K,Nome)),L),
eliminarRepetidos(L,Prof).
\end{verbatim}

\newpage
\begin{figure}[<+htpb+>]
	\centering
	\includegraphics[scale=0.9]{answer8.png}
	\caption{Exemplo da execução do axioma instSerProf}
	\label{p3:fig:output8}
\end{figure}


\subsection{Registar utentes, profissionais, serviços ou instituições}
\begin{Verbatim}
adicionarUtentes(Codigo,Utente):- 
inserirConhecimento(utente(Codigo,Utente)).

adicionarServico(Servico):- 
inserirConhecimento(servico(Servico)).

adicionarProfissional(Codigo,Profissional):-
 inserirConhecimento(profissional(Codigo,Profissional)).

adicionarInstituicao(Nome):- 
inserirConhecimento(instituicao(Nome)).


\end{Verbatim}

\begin{figure}[<+htpb+>]
	\centering
	\includegraphics[scale=0.9]{answer9.png}
	\caption{Exemplo da execução do axioma adicionar utente, profissionais, serviço ou instituições}
	\label{p3:fig:output9}
\end{figure}

\subsection{Remover utente (profissionais, serviços, instituições) dos registos}

\begin{Verbatim}
removerUtentes(Codigo,Utente):- remover(utente(Codigo,Utente)).

removerServico(Servico):- remover(servico(Servico)).

removerProfissional(Codigo,Profissional):- remover(profissional(Codigo,Profissional)).

removerInstituicao(Nome):- remover(instituicao(Nome)).
\end{Verbatim}

\begin{figure}[<+htpb+>]
	\centering
	\includegraphics[scale=0.9]{answer10.png}
	\caption{Exemplo da execução do axioma profiServico}
	\label{p3:fig:output10}
\end{figure}

\subsection{Funcionalidades Extra}
